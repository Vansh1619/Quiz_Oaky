<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Quizoaky - Timed & Secure Quiz</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="QuizOaky_Logo.png" sizes="any">

    <!-- External CSS -->
    <link rel="stylesheet" href="QuizOaky_Final.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ Quizoaky</h1>
            <p>âœ… Universal Compatibility: Works on Any Phone, Tablet, or PC.</p>
        </div>

        <div class="content">
            <div id="roleSelection" class="role-selection">
                <h2>Choose Your Role</h2>
                <p>âœ… Students can use any device<br>âœ… Results are automatically collected in the teacher's Excel!</p>
                
                <div class="role-buttons">
                    <button class="role-btn" onclick="selectRole('teacher')">
                        ğŸ‘¨â€ğŸ« Teacher<br>
                        <small>Create quiz & collect results</small>
                    </button>
                    <button class="role-btn" onclick="selectRole('student')">
                        ğŸ‘¨â€ğŸ“ Student<br>
                        <small>Take quiz on any device</small>
                    </button>
                </div>
            </div>

            <div id="teacherPanel" class="panel">
                <button class="back-btn" onclick="goHome()">â† Back to Home</button>
                
                <div id="shareSection" class="share-section" style="display: none;">
                    <h3>ğŸ“¤ Share Quiz Link with Students</h3>
                    <p><strong>Quiz ID:</strong> <span id="displayQuizId">Generating...</span></p>
                    
                    <div class="quiz-link" id="quizLink">Generating quiz link...</div>
                    <button id="copyQuizBtn" class="copy-btn" onclick="copyQuizLink()">ğŸ“‹ Copy Quiz Link</button>
                    
                    <p style="margin-top: 15px; color: #2e7d32; font-weight: bold;">
                        âœ… Students will send you their result links automatically after completing the quiz!
                    </p>
                </div>

                <div class="section">
                    <h3>ğŸ“ Create New Question</h3>
                    <form id="questionForm">
                        <div class="form-group">
                            <label>Question:</label>
                            <textarea id="questionText" placeholder="Enter your question here..." rows="3" required></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Answer Options (select the correct answer):</label>
                            <div class="options-container">
                                <div class="option-input">
                                    <input type="radio" name="correctOption" value="0" required>
                                    <span class="option-label">A.</span>
                                    <input type="text" id="optionText0" placeholder="Enter option A" required>
                                </div>
                                <div class="option-input">
                                    <input type="radio" name="correctOption" value="1">
                                    <span class="option-label">B.</span>
                                    <input type="text" id="optionText1" placeholder="Enter option B" required>
                                </div>
                                <div class="option-input">
                                    <input type="radio" name="correctOption" value="2">
                                    <span class="option-label">C.</span>
                                    <input type="text" id="optionText2" placeholder="Enter option C" required>
                                </div>
                                <div class="option-input">
                                    <input type="radio" name="correctOption" value="3">
                                    <span class="option-label">D.</span>
                                    <input type="text" id="optionText3" placeholder="Enter option D" required>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">âœ… Add Question</button>
                        <button type="button" class="btn btn-info" onclick="exportQuestions()">ğŸ“¥ Export Questions</button>
                        <button type="button" class="btn btn-success" onclick="generateNewQuiz()">ğŸ”„ New Quiz</button>
                    </form>
                </div>

                <div class="section">
                    <h3>ğŸ“‹ Questions (<span id="questionCount">0</span>)</h3>
                    <div id="questionsList" class="questions-list"></div>
                    <button id="clearQsBtn" class="btn btn-danger" onclick="clearAllQuestions()" style="margin-top: 10px;">
                        ğŸ—‘ï¸ Clear Questions
                    </button>
                </div>

                <div class="section">
                    <h3>ğŸ“Š Collect Student Results</h3>
                    <div class="collect-section">
                        <h4>ğŸ”— Paste Student Result Links Here:</h4>
                        <p style="margin-bottom: 10px; color: #666;">Students will share result links with you after completing the quiz. Paste all links below (one per line):</p>
                        <textarea id="resultUrls" class="url-input" placeholder="Paste student result links here, one per line..."></textarea>
                        <button id="collectBtn" class="btn btn-primary" onclick="collectResults()">ğŸ”„ Collect All Results</button>
                    </div>
                    
                    <div id="collectedResultsList" class="results-list">
                        <p style="text-align: center; color: #666; padding: 20px;">No results collected yet. Results will appear here when you paste student result links above.</p>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <button id="downloadAllBtn" class="btn btn-success" onclick="downloadAllResults()">ğŸ“¥ Download All Results (Excel)</button>
                        <button id="clearResultsBtn" class="btn btn-danger" onclick="clearCollectedResults()">ğŸ—‘ï¸ Clear Results</button>
                    </div>
                </div>
            </div>

            <div id="studentJoin" class="panel">
                <button class="back-btn" onclick="goHome()">â† Back to Home</button>
                
                <div class="section">
                    <h3>ğŸ‘¤ Enter Your Information</h3>
                    <div class="form-group">
                        <label>Your Name:</label>
                        <input type="text" id="studentName" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label>Paste Quiz Link from Teacher:</label>
                        <textarea id="joinCode" class="code-input" placeholder="Paste the complete quiz link your teacher shared with you here..."></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="joinQuiz()">ğŸš€ Join Quiz</button>
                    
                    <p style="margin-top: 20px; color: #666; text-align: center;">
                        <small>ğŸ’¡ Paste the complete link from your teacher. After completing the quiz, you'll get a result link to share back with them!</small>
                    </p>
                </div>
            </div>

            <div id="studentPanel" class="panel">
                <button class="back-btn" onclick="goBackToJoin()">â† Enter Different Link</button>
                
                <div class="student-info">
                    <div class="student-name">ğŸ‘¤ Student: <span id="currentStudentName">Unknown</span></div>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">Quiz ID: <span id="studentQuizId">Unknown</span></div>
                </div>
                
                <div id="quizStart" class="section">
                    <h3>ğŸš€ Ready to Take the Quiz?</h3>
                    <p id="quizInfo">Loading quiz information...</p>
                    <button id="startQuizBtn" class="btn btn-primary" onclick="startQuiz()" disabled>
                        Start Quiz
                    </button>
                </div>

                <div id="quizInterface" class="quiz-interface">
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    
                    <div id="currentQuestion" class="question-container"></div>

                    <div class="navigation">
                        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">
                            Next
                        </button>
                    </div>
                </div>

                <div id="results" class="results">
                    <div class="score-circle" id="scoreCircle">0/0</div>
                    <h2 id="resultTitle">Quiz Complete!</h2>
                    <p id="resultMessage">Great job on completing the quiz!</p>
                    
                    <div id="resultUrlSection" class="result-url-section">
                        <h4>ğŸ“¤ IMPORTANT: Share This Link with Your Teacher</h4>
                        <p><strong>Copy and send this link to your teacher:</strong></p>
                        <div class="result-url" id="resultUrl">Generating...</div>
                        <button id="copyResultBtn" class="copy-btn" onclick="copyResultUrl()">ğŸ“‹ Copy Result Link</button>
                        <p style="margin-top: 10px;"><small>ğŸ’¡ Your teacher needs this link to include your score in the class results Excel file!</small></p>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <button class="btn btn-primary" onclick="downloadResults()">
                            ğŸ“¥ Download My Results
                        </button>
                        <button id="retakeBtn" class="btn btn-secondary" onclick="retakeQuiz()">
                            ğŸ”„ Retake Quiz
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
             <p>&copy; 2025 Vansh, Prushti, Hetu. All rights reserved.</p>
        </div>
    </div>

    <!-- xlsx library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- External JS -->
    <script src="QuizOaky_Final.js"></script>
</body>
</html>
